<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/paper-input/paper-input.html">

<!-- <link rel="import" href="../../bower_components/iron-a11y-keys-behavior/iron-a11y-keys-behavior.html"> -->

<link rel="import" href="../rpn-row/rpn-row.html">


<script src="../../bundle.js" charset="utf-8"></script>


<dom-module id="rpn-app">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <!-- <iron-a11y-keys id="a11y" target="[[target]]" keys="enter" on-keys-pressed="_handleKeyDown"></iron-a11y-keys>
    <paper-input id="input"
                 placeholder="Type something. Press enter. Check console."
                 value="{{userInput::input}}"></paper-input> -->

    <paper-input label="Input RPN Expression" on-keydown="_handleKeyDown" value="{{userInput}}"></paper-input>
    <div class="history">
      <template is="dom-repeat" items="[[inputHistory]]">
        <rpn-row expression="[[item]]"></rpn-row>
      </template>
    </div>
  </template>

  <script>
    Polymer({

      is: 'rpn-app',

      properties: {
        userInput: {
          type: String,
          notify: true,
        },
        inputHistory: {
          type: Object,
          value: []
        }
        // target: {
        //   type: Object,
        //   value: function() {
        //     return this.$.input;
        //   }
        // },
      },

      ready: function() {
        this.unshift('inputHistory', "1 2 *");
        this.unshift('inputHistory', "3 4 5 - *");
      },

      _handleKeyDown: function(e){
        if(e.keyCode === 13){
          // register
          // flush

          this.unshift('inputHistory', this.userInput);
          console.log(RPN.solveRPN(this.userInput));
          this.userInput = "";
          // e.preventDefault();
        }
      }

    });
  </script>
</dom-module>
